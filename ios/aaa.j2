{{% if tag == "legacy"%}}
{% for server in config_context["aaa"]["servers"] -%}
tacacs-server host {{ server }}
{% endfor -%}
{{% else %}}
aaa group server tacacs+ ISE
{% for server in config_context["aaa"]["servers"] %}
 server name ISE{{ loop.index }}
{% endfor %}
 ip tacacs source-interface {{ primary_ip4["interface"]["name"] }}
!
{% for server in config_context["aaa"]["servers"] %}
tacacs server ISE{{ loop.index }}
 address ipv4 {{ server }}
 key 7 06031D344F4B1A1606041B08
 timeout 10
{% endfor -%}
{{% endif %}}
!
aaa authentication login default group ISE local
aaa authentication enable default group ISE enable
aaa authorization config-commands
aaa authorization exec default group ISE if-authenticated
aaa authorization commands 0 default group ISE if-authenticated 
aaa authorization commands 1 default group ISE if-authenticated 
aaa authorization commands 15 default group ISE if-authenticated 
aaa authorization reverse-access default group ISE if-authenticated 
aaa accounting update newinfo
aaa accounting dot1x default start-stop group ISE
aaa accounting exec default start-stop group ISE
aaa accounting commands 0 default start-stop group ISE
aaa accounting commands 1 default start-stop group ISE
aaa accounting commands 15 default start-stop group ISE
aaa accounting connection default start-stop group ISE
aaa accounting system default start-stop group ISE
aaa session-id common
